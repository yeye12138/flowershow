---
share_link: https://share.note.sx/qjpiiqm6#9OS3++mtKXyu/P+K1lxEk1xxYiiIxdncpkfCcyQbR98
share_updated: 2025-07-10T16:15:08+08:00
---
### 在文档尾部加入一个链接汇总的代码块

---
```dataviewjs
// 获取当前文件
const currentFile = dv.current().file

// 读取文件内容
const content = await dv.io.load(currentFile.path)

// 匹配外部链接的正则表达式（匹配[text](url)和<url>格式）
const linkRegex = /\[([^\]]+)\]\((https?:\/\/[^\)]+)\)|(https?:\/\/[^\s>]+)/g

// 存储找到的链接
let links = []
let match

// 查找所有匹配的链接
while ((match = linkRegex.exec(content)) !== null) {
    if (match[1] && match[2]) {
        // [text](url) 格式
        links.push({text: match[1], url: match[2]})
    } else if (match[3]) {
        // 纯URL格式
        links.push({text: match[3], url: match[3]})
    }
}

// 去重
const uniqueLinks = [...new Map(links.map(item => [item.url, item])).values()]

// 显示结果
if (uniqueLinks.length > 0) {
    dv.header(3, "外部链接统计 (" + uniqueLinks.length + "个)");
    dv.list(uniqueLinks.map(link => `[${link.text}](${link.url})`));
} else {
    dv.paragraph("本文档没有包含外部链接。");
}
```
---
